import unittest
import StringIO
import warnings
from itcc.molecule import read
from itcc.ccs2 import detectloop

in_str = '''\
    34  molden generated tinker .xyz (mm3 param.)
     1  C     -0.299313   -0.731773    0.091523     1     2     3    13    18
     2  C     -0.418179   -0.584204    1.624583     1     1     4     5     6
     3  C      1.065422   -0.274523   -0.495834     1     1    19    20    30
     4  C     -0.461069    0.886332    2.065572     1     2     7     8     9
     5  H     -1.358162   -1.079713    1.966712     5     2
     6  H      0.396231   -1.126367    2.156427     5     2
     7  C     -1.630907    1.622699    1.397030     1     4    10    11    12
     8  H     -0.566295    0.946017    3.175725     5     4
     9  H      0.500033    1.391103    1.811983     5     4
    10  C     -1.597139    1.460683   -0.129491     1     7    13    14    15
    11  H     -2.592245    1.210385    1.786678     5     7
    12  H     -1.607630    2.705591    1.668305     5     7
    13  C     -1.528808   -0.023366   -0.518927     1     1    10    16    17
    14  H     -2.507794    1.928012   -0.576042     5    10
    15  H     -0.722183    2.008598   -0.550336     5    10
    16  H     -2.457028   -0.524353   -0.153422     5    13
    17  H     -1.564081   -0.137376   -1.626085     5    13
    18  H     -0.390272   -1.820228   -0.146287     5     1
    19  C      1.128024   -0.450588   -2.028451     1     3    21    22    23
    20  H      1.208671    0.810185   -0.283836     5     3
    21  C      2.484735   -0.040671   -2.620101     1    19    24    25    26
    22  H      0.920190   -1.515693   -2.286747     5    19
    23  H      0.351484    0.171635   -2.530027     5    19
    24  C      3.627591   -0.828189   -1.970959     1    21    27    28    29
    25  H      2.487574   -0.213215   -3.723561     5    21
    26  H      2.646734    1.052162   -2.460249     5    21
    27  C      3.608055   -0.611549   -0.454248     1    24    30    31    32
    28  H      3.514695   -1.914864   -2.198952     5    24
    29  H      4.608113   -0.500638   -2.393230     5    24
    30  C      2.254585   -1.023720    0.143257     1     3    27    33    34
    31  H      4.430001   -1.199863    0.020862     5    27
    32  H      3.803587    0.464033   -0.228437     5    27
    33  H      2.112981   -2.122359    0.011690     5    30
    34  H      2.306000   -0.823346    1.238210     5    30
'''


class Test(unittest.TestCase):
    def runTest(self):
        mol = read.readxyz(StringIO.StringIO(in_str))
        res = detectloop.loopdetect(mol)
        if res[0] != 1:
            warnings.warn("res[0] should be 1")
        

if __name__ == '__main__':
    unittest.main()
